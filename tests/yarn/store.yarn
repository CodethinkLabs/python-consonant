Black box tests for the consonant.store module
==============================================

The scenario tests in this document aim to provide extensive coverage
of the `consonant.store` module, which provides a Python API to access
Consonant stores.

The tests operate against a set of public test schemas and stores, all
of which are given names like `simple kanban store`. These test stores
have specific properties such as particular branches, tags or commits
being present, so it may not always be obvious why a scenario test is
correct.

Listing all Git refs in a store
-------------------------------

    SCENARIO list Git refs in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     listing Git refs using consonant.store

Make sure all the expected local branches are present:

    THEN     the refs include a local branch called "HEAD"
    AND      the refs include a local branch called "master"
    AND      the local branch "HEAD" has an alias "HEAD"
    AND      the local branch "master" has an alias "master"
    AND      the local branch "master" has an alias "refs:heads:master"

Make sure all the expected remote branches are present:

    AND      the refs include a remote branch called "origin/HEAD"
    AND      the refs include a remote branch called "origin/master"
    AND      the remote branch "origin/HEAD" has an alias "origin:HEAD"
    AND      the remote branch "origin/HEAD" has an alias "refs:remotes:origin:HEAD"
    AND      the remote branch "origin/master" has an alias "origin:master"
    AND      the remote branch "origin/master" has an alias "refs:remotes:origin:master"

Make sure all the expected tags are present:

    AND      the refs include a tag called "initial-data-set"
    AND      the refs include a tag called "second-commit"
    AND      the tag "initial-data-set" has an alias "initial-data-set"
    AND      the tag "initial-data-set" has an alias "refs:tags:initial-data-set"
    AND      the tag "second-commit" has an alias "second-commit"
    AND      the tag "second-commit" has an alias "refs:tags:second-commit"

Fetching individual refs from a store
-------------------------------------

    SCENARIO fetch the Git ref "HEAD" from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "HEAD" using consonant.store
    THEN     the field "type" is set to "branch"
    AND      the field "url-aliases" is set to ["HEAD"]
    AND      the field "head" > "sha1" is set to "45e0ee91b24bd37ebac2c99fdbadc5bfdc0d19d8"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378139687 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378226671 +0100"
    AND      the field "head" > "subject" is set to "Add another card to the doing lane"
    AND      the field "head" > "parents" is set to ["8cb438859cc3bdbfe6b2f685187b2a3b60331447"]

    SCENARIO fetch the Git ref "refs/heads/master" from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "refs/heads/master" using consonant.store
    THEN     the field "type" is set to "branch"
    AND      the field "url-aliases" is set to ["master", "refs:heads:master"]
    AND      the field "head" > "sha1" is set to "45e0ee91b24bd37ebac2c99fdbadc5bfdc0d19d8"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378139687 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378226671 +0100"
    AND      the field "head" > "subject" is set to "Add another card to the doing lane"
    AND      the field "head" > "parents" is set to ["8cb438859cc3bdbfe6b2f685187b2a3b60331447"]

    SCENARIO fetch the Git ref "master" from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "master" using consonant.store
    THEN     the field "type" is set to "branch"
    AND      the field "url-aliases" is set to ["master", "refs:heads:master"]
    AND      the field "head" > "sha1" is set to "45e0ee91b24bd37ebac2c99fdbadc5bfdc0d19d8"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378139687 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378226671 +0100"
    AND      the field "head" > "subject" is set to "Add another card to the doing lane"
    AND      the field "head" > "parents" is set to ["8cb438859cc3bdbfe6b2f685187b2a3b60331447"]

    SCENARIO fetch the Git ref "refs:heads:master" from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "refs:heads:master" using consonant.store
    THEN     the field "type" is set to "branch"
    AND      the field "url-aliases" is set to ["master", "refs:heads:master"]
    AND      the field "head" > "sha1" is set to "45e0ee91b24bd37ebac2c99fdbadc5bfdc0d19d8"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378139687 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378226671 +0100"
    AND      the field "head" > "subject" is set to "Add another card to the doing lane"
    AND      the field "head" > "parents" is set to ["8cb438859cc3bdbfe6b2f685187b2a3b60331447"]

    SCENARIO fetch the Git ref "refs/remotes/origin/HEAD" from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "refs/remotes/origin/HEAD" using consonant.store
    THEN     the field "type" is set to "branch"
    AND      the field "url-aliases" is set to ["origin:HEAD", "refs:remotes:origin:HEAD"]
    AND      the field "head" > "sha1" is set to "45e0ee91b24bd37ebac2c99fdbadc5bfdc0d19d8"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378139687 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378226671 +0100"
    AND      the field "head" > "subject" is set to "Add another card to the doing lane"
    AND      the field "head" > "parents" is set to ["8cb438859cc3bdbfe6b2f685187b2a3b60331447"]

    SCENARIO fetch the Git ref "origin:HEAD" from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "origin:HEAD" using consonant.store
    THEN     the field "type" is set to "branch"
    AND      the field "url-aliases" is set to ["origin:HEAD", "refs:remotes:origin:HEAD"]
    AND      the field "head" > "sha1" is set to "45e0ee91b24bd37ebac2c99fdbadc5bfdc0d19d8"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378139687 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378226671 +0100"
    AND      the field "head" > "subject" is set to "Add another card to the doing lane"
    AND      the field "head" > "parents" is set to ["8cb438859cc3bdbfe6b2f685187b2a3b60331447"]

    SCENARIO fetch the Git ref "refs:remotes:origin:HEAD" from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "refs:remotes:origin:HEAD" using consonant.store
    THEN     the field "type" is set to "branch"
    AND      the field "url-aliases" is set to ["origin:HEAD", "refs:remotes:origin:HEAD"]
    AND      the field "head" > "sha1" is set to "45e0ee91b24bd37ebac2c99fdbadc5bfdc0d19d8"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378139687 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378226671 +0100"
    AND      the field "head" > "subject" is set to "Add another card to the doing lane"
    AND      the field "head" > "parents" is set to ["8cb438859cc3bdbfe6b2f685187b2a3b60331447"]

    SCENARIO fetch the Git ref "refs/remotes/origin/master" from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "refs/remotes/origin/master" using consonant.store
    THEN     the field "type" is set to "branch"
    AND      the field "url-aliases" is set to ["origin:master", "refs:remotes:origin:master"]
    AND      the field "head" > "sha1" is set to "45e0ee91b24bd37ebac2c99fdbadc5bfdc0d19d8"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378139687 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378226671 +0100"
    AND      the field "head" > "subject" is set to "Add another card to the doing lane"
    AND      the field "head" > "parents" is set to ["8cb438859cc3bdbfe6b2f685187b2a3b60331447"]

    SCENARIO fetch the Git ref "origin:master" from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "origin:master" using consonant.store
    THEN     the field "type" is set to "branch"
    AND      the field "url-aliases" is set to ["origin:master", "refs:remotes:origin:master"]
    AND      the field "head" > "sha1" is set to "45e0ee91b24bd37ebac2c99fdbadc5bfdc0d19d8"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378139687 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378226671 +0100"
    AND      the field "head" > "subject" is set to "Add another card to the doing lane"
    AND      the field "head" > "parents" is set to ["8cb438859cc3bdbfe6b2f685187b2a3b60331447"]

    SCENARIO fetch the Git ref "refs:remotes:origin:master" from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "refs:remotes:origin:master" using consonant.store
    THEN     the field "type" is set to "branch"
    AND      the field "url-aliases" is set to ["origin:master", "refs:remotes:origin:master"]
    AND      the field "head" > "sha1" is set to "45e0ee91b24bd37ebac2c99fdbadc5bfdc0d19d8"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378139687 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378226671 +0100"
    AND      the field "head" > "subject" is set to "Add another card to the doing lane"
    AND      the field "head" > "parents" is set to ["8cb438859cc3bdbfe6b2f685187b2a3b60331447"]

    SCENARIO fetch the Git ref "refs/tags/initial-data-set" from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "refs/tags/initial-data-set" using consonant.store
    THEN     the field "type" is set to "tag"
    AND      the field "url-aliases" is set to ["initial-data-set", "refs:tags:initial-data-set"]
    AND      the field "head" > "sha1" is set to "8cb438859cc3bdbfe6b2f685187b2a3b60331447"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378118698 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378118698 +0100"
    AND      the field "head" > "subject" is set to "Add initial set of cards and lanes"
    AND      the field "head" > "parents" is set to []

    SCENARIO fetch the Git ref "refs:tags:initial-data-set" from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "refs:tags:initial-data-set" using consonant.store
    THEN     the field "type" is set to "tag"
    AND      the field "url-aliases" is set to ["initial-data-set", "refs:tags:initial-data-set"]
    AND      the field "head" > "sha1" is set to "8cb438859cc3bdbfe6b2f685187b2a3b60331447"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378118698 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378118698 +0100"
    AND      the field "head" > "subject" is set to "Add initial set of cards and lanes"
    AND      the field "head" > "parents" is set to []

    SCENARIO fetch the Git ref "initial-data-set" from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "initial-data-set" using consonant.store
    THEN     the field "type" is set to "tag"
    AND      the field "url-aliases" is set to ["initial-data-set", "refs:tags:initial-data-set"]
    AND      the field "head" > "sha1" is set to "8cb438859cc3bdbfe6b2f685187b2a3b60331447"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378118698 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378118698 +0100"
    AND      the field "head" > "subject" is set to "Add initial set of cards and lanes"
    AND      the field "head" > "parents" is set to []

    SCENARIO fetch the Git ref "refs/tags/second-commit" from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "refs/tags/second-commit" using consonant.store
    THEN     the field "type" is set to "tag"
    AND      the field "url-aliases" is set to ["second-commit", "refs:tags:second-commit"]
    AND      the field "head" > "sha1" is set to "45e0ee91b24bd37ebac2c99fdbadc5bfdc0d19d8"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378139687 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378226671 +0100"
    AND      the field "head" > "subject" is set to "Add another card to the doing lane"
    AND      the field "head" > "parents" is set to ["8cb438859cc3bdbfe6b2f685187b2a3b60331447"]

    SCENARIO fetch the Git ref "second-commit" from a local store using
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "second-commit" using consonant.store
    THEN     the field "type" is set to "tag"
    AND      the field "url-aliases" is set to ["second-commit", "refs:tags:second-commit"]
    AND      the field "head" > "sha1" is set to "45e0ee91b24bd37ebac2c99fdbadc5bfdc0d19d8"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378139687 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378226671 +0100"
    AND      the field "head" > "subject" is set to "Add another card to the doing lane"
    AND      the field "head" > "parents" is set to ["8cb438859cc3bdbfe6b2f685187b2a3b60331447"]

    SCENARIO fetch the Git ref "refs:tags:second-commit" from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the ref "refs:tags:second-commit" using consonant.store
    THEN     the field "type" is set to "tag"
    AND      the field "url-aliases" is set to ["second-commit", "refs:tags:second-commit"]
    AND      the field "head" > "sha1" is set to "45e0ee91b24bd37ebac2c99fdbadc5bfdc0d19d8"
    AND      the field "head" > "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "author-date" is set to "1378139687 +0100"
    AND      the field "head" > "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "head" > "committer-date" is set to "1378226671 +0100"
    AND      the field "head" > "subject" is set to "Add another card to the doing lane"
    AND      the field "head" > "parents" is set to ["8cb438859cc3bdbfe6b2f685187b2a3b60331447"]

    SCENARIO fetch a non-existent Git ref from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the non-existent ref "non-existent-ref" using consonant.store
    THEN     a RefNotFoundError is thrown

Fetching individual commits from a store
----------------------------------------

    SCENARIO fetch a commit from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the commit 8cb43885 using consonant.store
    THEN     the field "sha1" is set to "8cb438859cc3bdbfe6b2f685187b2a3b60331447"
    AND      the field "parents" is set to []
    AND      the field "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "author-date" is set to "1378118698 +0100"
    AND      the field "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "committer-date" is set to "1378118698 +0100"
    AND      the field "subject" is set to "Add initial set of cards and lanes"

    SCENARIO fetch another commit from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the commit 45e0ee91 using consonant.store
    THEN     the field "sha1" is set to "45e0ee91b24bd37ebac2c99fdbadc5bfdc0d19d8"
    AND      the field "parents" is set to ["8cb438859cc3bdbfe6b2f685187b2a3b60331447"]
    AND      the field "author" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "author-date" is set to "1378139687 +0100"
    AND      the field "committer" is set to "Jannis Pohlmann <jannis.pohlmann@codethink.co.uk>"
    AND      the field "committer-date" is set to "1378226671 +0100"
    AND      the field "subject" is set to "Add another card to the doing lane"

    SCENARIO fetch a non-existent from a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the non-existent commit b7479fa9 using consonant.store
    THEN     a CommitNotFoundError is thrown

Obtaining the store name
------------------------

    SCENARIO obtain the store name from a commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     obtaining the store name from commit 8cb43885 using consonant.store
    THEN     the result is "com.github.consonant.consonant-test-store-01"

    SCENARIO obtain the store name from another commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     obtaining the store name from commit 45e0ee91 using consonant.store
    THEN     the result is "com.github.consonant.consonant-test-store-01"

    SCENARIO obtain the store name from a non-existent commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     obtaining the store name from the non-existent commit b7479fa9 using consonant.store
    THEN     a CommitNotFoundError is thrown

Obtaining the store schema
--------------------------

    SCENARIO obtain the schema name from a commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     obtaining the schema name from commit 8cb43885 using consonant.store
    THEN     the result is "com.github.consonant.consonant-test-schemas-01"

    SCENARIO obtain the schema name from another commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     obtaining the schema name from commit 45e0ee91 using consonant.store
    THEN     the result is "com.github.consonant.consonant-test-schemas-01"

    SCENARIO obtain the schema name from a non-existent commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     obtaining the schema name from the non-existent commit 950f9d21 using consonant.store
    THEN     a CommitNotFoundError is thrown

Obtaining the service aliases used in a commit
----------------------------------------------

    SCENARIO obtain service aliases from a commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     obtaining service aliases from commit 34bf243e using consonant.store
    THEN     the field "issues" is set to "the.service.name.of.an.issue.store"
    THEN     the field "reviews" is not present

    SCENARIO obtain service aliases from another commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     obtaining service aliases from commit bb53dce using consonant.store
    THEN     the field "issues" is set to "the.service.name.of.an.issue.store"
    THEN     the field "reviews" is set to "the.service.name.of.a.code.review.store"

    SCENARIO obtain service aliases from a non-existent commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     obtaining service aliases from the non-existent commit b7479fa9 using consonant.store
    THEN     a CommitNotFoundError is thrown

    SCENARIO obtain service aliases from a commit in a local store using consonant.store where no aliases are defined
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     obtaining service aliases from commit 45e0ee91 using consonant.store
    THEN     the result is an empty mapping

Obtaining the classes present in a commit
-----------------------------------------

    SCENARIO obtain classes from a commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     obtaining the classes from commit 8cb43885 using consonant.store

    THEN     the field "lane" is present
    AND      the size of field "lane" > "objects" is 2
    AND      the field "lane" > "objects" includes the reference "27519b8d-8ad8-4558-8ea2-f128404e6f58"
    AND      the field "lane" > "objects" includes the reference "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"

    AND      the field "card" is present
    AND      the size of field "card" > "objects" is 5
    AND      the field "card" > "objects" includes the reference "04be5c1b-0192-4e31-b4f8-39a084659738"
    AND      the field "card" > "objects" includes the reference "7501f1f4-e357-4af4-b5ff-546fae3f25f4"
    AND      the field "card" > "objects" includes the reference "86ab9538-3926-42ff-9fc7-e122a006cd4d"
    AND      the field "card" > "objects" includes the reference "dd7ff995-eba8-46e0-93d4-7297a691919e"
    AND      the field "card" > "objects" includes the reference "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd"
    AND      the field "card" > "objects" does not include the reference "633715b8-70ea-4b06-94c6-43ee83a8df9e"

    SCENARIO obtain classes from another commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     obtaining the classes from commit 45e0ee91 using consonant.store

    THEN     the field "lane" is present
    AND      the size of field "lane" > "objects" is 2
    AND      the field "lane" > "objects" includes the reference "27519b8d-8ad8-4558-8ea2-f128404e6f58"
    AND      the field "lane" > "objects" includes the reference "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"

    AND      the field "card" is present
    AND      the size of field "card" > "objects" is 6
    AND      the field "card" > "objects" includes the reference "04be5c1b-0192-4e31-b4f8-39a084659738"
    AND      the field "card" > "objects" includes the reference "7501f1f4-e357-4af4-b5ff-546fae3f25f4"
    AND      the field "card" > "objects" includes the reference "86ab9538-3926-42ff-9fc7-e122a006cd4d"
    AND      the field "card" > "objects" includes the reference "dd7ff995-eba8-46e0-93d4-7297a691919e"
    AND      the field "card" > "objects" includes the reference "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd"
    AND      the field "card" > "objects" includes the reference "633715b8-70ea-4b06-94c6-43ee83a8df9e"

    SCENARIO obtain classes from a non-existent commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     obtaining the classes from the non-existent commit 12345678 using consonant.store
    THEN     a CommitNotFoundError is thrown

Fetching objects from a commit
------------------------------

    SCENARIO fetch objects from a commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching objects from commit 8cb43885 using consonant.store

    THEN     the field "lane" is present
    AND      the size of field "lane" is 2

    AND      the field "lane" includes the object "27519b8d-8ad8-4558-8ea2-f128404e6f58"
    AND      the field "class" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is set to "lane"
    AND      the field "properties" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is present
    AND      the property "title" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is set to "Backlog"
    AND      the property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" includes the reference "dd7ff995-eba8-46e0-93d4-7297a691919e"
    AND      the property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" includes the reference "86ab9538-3926-42ff-9fc7-e122a006cd4d"
    AND      the property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" includes the reference "04be5c1b-0192-4e31-b4f8-39a084659738"
    AND      the size of property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is 3

    AND      the field "lane" includes the object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"
    AND      the field "class" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is set to "lane"
    AND      the field "properties" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is present
    AND      the property "title" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is set to "Doing"
    AND      the property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" includes the reference "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd"
    AND      the property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" includes the reference "7501f1f4-e357-4af4-b5ff-546fae3f25f4"
    AND      the size of property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is 2

    AND      the field "card" is present
    AND      the size of field "card" is 5

    AND      the field "card" includes the object "04be5c1b-0192-4e31-b4f8-39a084659738"
    AND      the field "class" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" is set to "card"
    AND      the field "properties" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" is present
    AND      the property "title" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" is set to "Implement feature A"
    AND      the property "lane" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" references "27519b8d-8ad8-4558-8ea2-f128404e6f58"

    AND      the field "card" includes the object "7501f1f4-e357-4af4-b5ff-546fae3f25f4"
    AND      the field "class" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" is set to "card"
    AND      the field "properties" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" is present
    AND      the property "title" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" is set to "Write tests for feature A"
    AND      the property "lane" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" references "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"

    AND      the field "card" includes the object "86ab9538-3926-42ff-9fc7-e122a006cd4d"
    AND      the field "class" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" is set to "card"
    AND      the field "properties" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" is present
    AND      the property "title" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" is set to "Implement feature B"
    AND      the property "lane" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" references "27519b8d-8ad8-4558-8ea2-f128404e6f58"

    AND      the field "card" includes the object "dd7ff995-eba8-46e0-93d4-7297a691919e"
    AND      the field "class" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" is set to "card"
    AND      the field "properties" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" is present
    AND      the property "title" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" is set to "Implement feature C"
    AND      the property "lane" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" references "27519b8d-8ad8-4558-8ea2-f128404e6f58"

    AND      the field "card" includes the object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd"
    AND      the field "class" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" is set to "card"
    AND      the field "properties" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" is present
    AND      the property "title" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" is set to "Write tests for feature B"
    AND      the property "lane" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" references "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"

    SCENARIO fetch objects from another commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching objects from commit 45e0ee91 using consonant.store

    THEN     the field "lane" is present
    AND      the size of field "lane" is 2

    AND      the field "lane" includes the object "27519b8d-8ad8-4558-8ea2-f128404e6f58"
    AND      the field "class" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is set to "lane"
    AND      the field "properties" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is present
    AND      the property "title" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is set to "Backlog"
    AND      the property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" includes the reference "dd7ff995-eba8-46e0-93d4-7297a691919e"
    AND      the property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" includes the reference "86ab9538-3926-42ff-9fc7-e122a006cd4d"
    AND      the property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" includes the reference "04be5c1b-0192-4e31-b4f8-39a084659738"
    AND      the size of property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is 3

    AND      the field "lane" includes the object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"
    AND      the field "class" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is set to "lane"
    AND      the field "properties" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is present
    AND      the property "title" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is set to "Doing"
    AND      the property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" includes the reference "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd"
    AND      the property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" includes the reference "7501f1f4-e357-4af4-b5ff-546fae3f25f4"
    AND      the property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" includes the reference "633715b8-70ea-4b06-94c6-43ee83a8df9e"
    AND      the size of property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is 3

    AND      the field "card" is present
    AND      the size of field "card" is 6

    AND      the field "card" includes the object "04be5c1b-0192-4e31-b4f8-39a084659738"
    AND      the field "class" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" is set to "card"
    AND      the field "properties" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" is present
    AND      the property "title" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" is set to "Implement feature A"
    AND      the property "lane" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" references "27519b8d-8ad8-4558-8ea2-f128404e6f58"

    AND      the field "card" includes the object "7501f1f4-e357-4af4-b5ff-546fae3f25f4"
    AND      the field "class" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" is set to "card"
    AND      the field "properties" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" is present
    AND      the property "title" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" is set to "Write tests for feature A"
    AND      the property "lane" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" references "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"

    AND      the field "card" includes the object "86ab9538-3926-42ff-9fc7-e122a006cd4d"
    AND      the field "class" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" is set to "card"
    AND      the field "properties" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" is present
    AND      the property "title" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" is set to "Implement feature B"
    AND      the property "lane" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" references "27519b8d-8ad8-4558-8ea2-f128404e6f58"

    AND      the field "card" includes the object "dd7ff995-eba8-46e0-93d4-7297a691919e"
    AND      the field "class" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" is set to "card"
    AND      the field "properties" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" is present
    AND      the property "title" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" is set to "Implement feature C"
    AND      the property "lane" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" references "27519b8d-8ad8-4558-8ea2-f128404e6f58"

    AND      the field "card" includes the object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd"
    AND      the field "class" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" is set to "card"
    AND      the field "properties" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" is present
    AND      the property "title" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" is set to "Write tests for feature B"
    AND      the property "lane" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" references "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"

    AND      the field "card" includes the object "633715b8-70ea-4b06-94c6-43ee83a8df9e"
    AND      the field "class" of object "633715b8-70ea-4b06-94c6-43ee83a8df9e" in "card" is set to "card"
    AND      the field "properties" of object "633715b8-70ea-4b06-94c6-43ee83a8df9e" in "card" is present
    AND      the property "title" of object "633715b8-70ea-4b06-94c6-43ee83a8df9e" in "card" is set to "Write tests for feature C"
    AND      the property "lane" of object "633715b8-70ea-4b06-94c6-43ee83a8df9e" in "card" references "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"

    SCENARIO fetch objects from a non-existent commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching objects from the non-existent commit 12345678 using consonant.store
    THEN     a CommitNotFoundError is thrown

Fetching objects of a given class from a commit
-----------------------------------------------

    SCENARIO fetch objects for a given class from a commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching objects of class "lane" from commit 8cb43885 using consonant.store

    THEN     the result is a list of size 2

    AND      the result includes the object "27519b8d-8ad8-4558-8ea2-f128404e6f58"
    AND      the field "class" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" is set to "lane"
    AND      the field "properties" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" is present
    AND      the property "title" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" is set to "Backlog"
    AND      the property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" includes the reference "dd7ff995-eba8-46e0-93d4-7297a691919e"
    AND      the property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" includes the reference "86ab9538-3926-42ff-9fc7-e122a006cd4d"
    AND      the property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" includes the reference "04be5c1b-0192-4e31-b4f8-39a084659738"
    AND      the size of property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" is 3

    AND      the result includes the object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"
    AND      the field "class" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" is set to "lane"
    AND      the field "properties" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" is present
    AND      the property "title" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" is set to "Doing"
    AND      the property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" includes the reference "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd"
    AND      the property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" includes the reference "7501f1f4-e357-4af4-b5ff-546fae3f25f4"
    AND      the size of property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" is 2

    AND      the field "card" is not present

    SCENARIO fetch objects for a given class from a non-existent commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching objects of class "lane" from the non-existent commit 12345678 using consonant.store
    THEN     a CommitNotFoundError is thrown

    SCENARIO fetch objects for a non-existent class from a commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching objects of non-existent class "non-existent-class" from commit 8cb43885 using consonant.store
    THEN     a ClassNotFoundError is thrown

Fetching individual objects from a commit
-----------------------------------------

    SCENARIO fetch an object from a commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the object "633715b8-70ea-4b06-94c6-43ee83a8df9e" from commit 45e0ee91 using consonant.store
    THEN     the field "class" is set to "card"
    AND      the field "properties" is present
    AND      the property "title" is set to "Write tests for feature C"
    AND      the property "lane" references "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"

    SCENARIO fetch another object from a commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" from commit 8cb43885 using consonant.store
    THEN     the field "class" is set to "lane"
    AND      the field "properties" is present
    AND      the property "title" is set to "Doing"
    AND      the property "cards" includes the reference "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd"
    AND      the property "cards" includes the reference "7501f1f4-e357-4af4-b5ff-546fae3f25f4"
    AND      the size of property "cards" is 2

    SCENARIO fetch an object from a non-existent commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" from the non-existent commit 12345678 using consonant.store
    THEN     a CommitNotFoundError is thrown

    SCENARIO fetch a non-existent object from a commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the non-existent object "081fa96f-0285-4b68-add4-c0039d4535f4" from commit 8cb43885 using consonant.store
    THEN     an ObjectNotFoundError is thrown

    SCENARIO fetch an object for a given class from a commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the object "633715b8-70ea-4b06-94c6-43ee83a8df9e" of class "card" from commit 45e0ee91 using consonant.store
    THEN     the field "class" is set to "card"
    AND      the field "properties" is present
    AND      the property "title" is set to "Write tests for feature C"
    AND      the property "lane" references "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"

    SCENARIO fetch another object for a given class from a commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" of class "lane" from commit 8cb43885 using consonant.store
    THEN     the field "class" is set to "lane"
    AND      the field "properties" is present
    AND      the property "title" is set to "Doing"
    AND      the property "cards" includes the reference "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd"
    AND      the property "cards" includes the reference "7501f1f4-e357-4af4-b5ff-546fae3f25f4"
    AND      the size of property "cards" is 2

    SCENARIO fetch an object for a given class from a non-existent commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" of class "lane" from the non-existent commit 12345678 using consonant.store
    THEN     a CommitNotFoundError is thrown

    SCENARIO fetch a non-existent object for a given class from a commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the non-existent object "081fa96f-0285-4b68-add4-c0039d4535f4" of class "card" from commit 8cb43885 using consonant.store
    THEN     an ObjectNotFoundError is thrown

    SCENARIO fetch a existent object for the wrong class from a commit in a local store using consonant.store
    GIVEN    a local standard test store "consonant-test-store-01"
    WHEN     fetching the object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" of the wrong class "card" from commit 8cb43885 using consonant.store
    THEN     an ObjectNotFoundError is thrown

Fetching objects from a commit using consonant.store with an object cache
-------------------------------------------------------------------------

Fetch objects once:

    SCENARIO fetch objects from a commit in a local store using consonant.store with an object cache once
    GIVEN    a local standard test store "consonant-test-store-01"
    AND      a local Memcached instance
    WHEN     fetching objects from commit 8cb43885 using consonant.store

    THEN     the field "lane" is present
    AND      the size of field "lane" is 2

    AND      the field "lane" includes the object "27519b8d-8ad8-4558-8ea2-f128404e6f58"
    AND      the field "class" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is set to "lane"
    AND      the field "properties" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is present
    AND      the property "title" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is set to "Backlog"
    AND      the property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" includes the reference "dd7ff995-eba8-46e0-93d4-7297a691919e"
    AND      the property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" includes the reference "86ab9538-3926-42ff-9fc7-e122a006cd4d"
    AND      the property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" includes the reference "04be5c1b-0192-4e31-b4f8-39a084659738"
    AND      the size of property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is 3

    AND      the field "lane" includes the object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"
    AND      the field "class" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is set to "lane"
    AND      the field "properties" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is present
    AND      the property "title" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is set to "Doing"
    AND      the property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" includes the reference "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd"
    AND      the property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" includes the reference "7501f1f4-e357-4af4-b5ff-546fae3f25f4"
    AND      the size of property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is 2

    AND      the field "card" is present
    AND      the size of field "card" is 5

    AND      the field "card" includes the object "04be5c1b-0192-4e31-b4f8-39a084659738"
    AND      the field "class" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" is set to "card"
    AND      the field "properties" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" is present
    AND      the property "title" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" is set to "Implement feature A"
    AND      the property "lane" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" references "27519b8d-8ad8-4558-8ea2-f128404e6f58"

    AND      the field "card" includes the object "7501f1f4-e357-4af4-b5ff-546fae3f25f4"
    AND      the field "class" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" is set to "card"
    AND      the field "properties" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" is present
    AND      the property "title" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" is set to "Write tests for feature A"
    AND      the property "lane" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" references "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"

    AND      the field "card" includes the object "86ab9538-3926-42ff-9fc7-e122a006cd4d"
    AND      the field "class" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" is set to "card"
    AND      the field "properties" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" is present
    AND      the property "title" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" is set to "Implement feature B"
    AND      the property "lane" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" references "27519b8d-8ad8-4558-8ea2-f128404e6f58"

    AND      the field "card" includes the object "dd7ff995-eba8-46e0-93d4-7297a691919e"
    AND      the field "class" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" is set to "card"
    AND      the field "properties" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" is present
    AND      the property "title" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" is set to "Implement feature C"
    AND      the property "lane" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" references "27519b8d-8ad8-4558-8ea2-f128404e6f58"

    AND      the field "card" includes the object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd"
    AND      the field "class" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" is set to "card"
    AND      the field "properties" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" is present
    AND      the property "title" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" is set to "Write tests for feature B"
    AND      the property "lane" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" references "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"

    AND      memcached has processed 7 get commands
    AND      memcached has processed 7 set commands
    AND      memcached holds 7 items
    AND      memcached has 0 hits
    AND      memcached has 7 misses

    AND      the memcached item 62cd229d8ce0ae10f85605f80c798449d36903e8 holds the object "27519b8d-8ad8-4558-8ea2-f128404e6f58"
    AND      the memcached item e30f2602a81c0a6fecd8d73c48dde41bf46792eb holds the object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"
    AND      the memcached item e78c8bb92dffee1745d24833b3a54a394f6292e7 holds the object "04be5c1b-0192-4e31-b4f8-39a084659738"
    AND      the memcached item 7b71a39ab7a33ea43e391e1e984dbc440b0ff3d3 holds the object "7501f1f4-e357-4af4-b5ff-546fae3f25f4"
    AND      the memcached item 315e0fb04fc23b973f66333645547b29887aa89e holds the object "86ab9538-3926-42ff-9fc7-e122a006cd4d"
    AND      the memcached item 41a0314e986ee6487dea06763b5da95b7aaf9832 holds the object "dd7ff995-eba8-46e0-93d4-7297a691919e"
    AND      the memcached item fbc6bd6caca73ded23e89cb01e3b89ddb37a7bc1 holds the object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd"

    FINALLY  stop the local Memcached instance

Fetch objects twice:

    SCENARIO fetch objects from a commit in a local store using consonant.store with an object cache twice
    GIVEN    a local standard test store "consonant-test-store-01"
    AND      a local Memcached instance
    WHEN     fetching objects from commit 8cb43885 using consonant.store
    AND      fetching objects from commit 8cb43885 using consonant.store

    THEN     the field "lane" is present
    AND      the size of field "lane" is 2

    AND      the field "lane" includes the object "27519b8d-8ad8-4558-8ea2-f128404e6f58"
    AND      the field "class" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is set to "lane"
    AND      the field "properties" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is present
    AND      the property "title" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is set to "Backlog"
    AND      the property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" includes the reference "dd7ff995-eba8-46e0-93d4-7297a691919e"
    AND      the property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" includes the reference "86ab9538-3926-42ff-9fc7-e122a006cd4d"
    AND      the property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" includes the reference "04be5c1b-0192-4e31-b4f8-39a084659738"
    AND      the size of property "cards" of object "27519b8d-8ad8-4558-8ea2-f128404e6f58" in "lane" is 3

    AND      the field "lane" includes the object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"
    AND      the field "class" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is set to "lane"
    AND      the field "properties" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is present
    AND      the property "title" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is set to "Doing"
    AND      the property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" includes the reference "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd"
    AND      the property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" includes the reference "7501f1f4-e357-4af4-b5ff-546fae3f25f4"
    AND      the size of property "cards" of object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527" in "lane" is 2

    AND      the field "card" is present
    AND      the size of field "card" is 5

    AND      the field "card" includes the object "04be5c1b-0192-4e31-b4f8-39a084659738"
    AND      the field "class" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" is set to "card"
    AND      the field "properties" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" is present
    AND      the property "title" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" is set to "Implement feature A"
    AND      the property "lane" of object "04be5c1b-0192-4e31-b4f8-39a084659738" in "card" references "27519b8d-8ad8-4558-8ea2-f128404e6f58"

    AND      the field "card" includes the object "7501f1f4-e357-4af4-b5ff-546fae3f25f4"
    AND      the field "class" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" is set to "card"
    AND      the field "properties" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" is present
    AND      the property "title" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" is set to "Write tests for feature A"
    AND      the property "lane" of object "7501f1f4-e357-4af4-b5ff-546fae3f25f4" in "card" references "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"

    AND      the field "card" includes the object "86ab9538-3926-42ff-9fc7-e122a006cd4d"
    AND      the field "class" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" is set to "card"
    AND      the field "properties" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" is present
    AND      the property "title" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" is set to "Implement feature B"
    AND      the property "lane" of object "86ab9538-3926-42ff-9fc7-e122a006cd4d" in "card" references "27519b8d-8ad8-4558-8ea2-f128404e6f58"

    AND      the field "card" includes the object "dd7ff995-eba8-46e0-93d4-7297a691919e"
    AND      the field "class" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" is set to "card"
    AND      the field "properties" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" is present
    AND      the property "title" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" is set to "Implement feature C"
    AND      the property "lane" of object "dd7ff995-eba8-46e0-93d4-7297a691919e" in "card" references "27519b8d-8ad8-4558-8ea2-f128404e6f58"

    AND      the field "card" includes the object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd"
    AND      the field "class" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" is set to "card"
    AND      the field "properties" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" is present
    AND      the property "title" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" is set to "Write tests for feature B"
    AND      the property "lane" of object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd" in "card" references "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"

    AND      memcached has processed 14 get commands
    AND      memcached has processed 14 set commands
    AND      memcached holds 7 items
    AND      memcached has 7 hits
    AND      memcached has 7 misses

    AND      the memcached item 62cd229d8ce0ae10f85605f80c798449d36903e8 holds the object "27519b8d-8ad8-4558-8ea2-f128404e6f58"
    AND      the memcached item e30f2602a81c0a6fecd8d73c48dde41bf46792eb holds the object "71bd32d7-f02c-4cdd-9f91-1e73ba9a9527"
    AND      the memcached item e78c8bb92dffee1745d24833b3a54a394f6292e7 holds the object "04be5c1b-0192-4e31-b4f8-39a084659738"
    AND      the memcached item 7b71a39ab7a33ea43e391e1e984dbc440b0ff3d3 holds the object "7501f1f4-e357-4af4-b5ff-546fae3f25f4"
    AND      the memcached item 315e0fb04fc23b973f66333645547b29887aa89e holds the object "86ab9538-3926-42ff-9fc7-e122a006cd4d"
    AND      the memcached item 41a0314e986ee6487dea06763b5da95b7aaf9832 holds the object "dd7ff995-eba8-46e0-93d4-7297a691919e"
    AND      the memcached item fbc6bd6caca73ded23e89cb01e3b89ddb37a7bc1 holds the object "efb3c4e5-3ee0-4171-bddd-a56e9b0765cd"

    FINALLY  stop the local Memcached instance
